<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Reminder Application</title>
  </head>
  <body>
    <h1>Reminder Application</h1>
  </body>
  <!-- ------------------- service worker -------------------- -->
  <script>
    // if ('serviceWorker' in navigator) {
    //   window.addEventListener('load', function () {
    //     navigator.serviceWorker.register('/js/service-worker.js').then(
    //       function (registration) {
    //         // Registration was successful
    //         console.log(
    //           'ServiceWorker registration successful with scope: ',
    //           registration.scope,
    //         );
    //       },
    //       function (err) {
    //         // registration failed :(
    //         console.log('ServiceWorker registration failed: ', err);
    //       },
    //     );
    //   });
    // }

    const checkPermission = () => {
      if (!('serviceWorker' in navigator)) {
        throw new Error('No support for service worker!');
      }

      if (!('Notification' in window)) {
        throw new Error('No support for notification API');
      }

      if (!('PushManager' in window)) {
        throw new Error('No support for Push API');
      }
    };

    const registerSW = async () => {
      const registration = await navigator.serviceWorker.register('/js/service-worker.js');
      return registration;
    };

    const requestNotificationPermission = async () => {
      const permission = await Notification.requestPermission();

      if (permission !== 'granted') {
        throw new Error('Notification permission not granted');
      }
    };

    const main = async () => {
      checkPermission();
      await requestNotificationPermission();
      await registerSW();
    };
  </script>
  <!-- ------------------------------------------------------- -->
</html>
